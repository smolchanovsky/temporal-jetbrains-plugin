# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

JetBrains IDE plugin for browsing and navigating Temporal workflows. Written in Kotlin, targeting IntelliJ Platform 2025.2+ with Java 21.

## Build Commands

```bash
# Build plugin artifact
./gradlew buildPlugin

# Run IDE with plugin installed (for testing)
./gradlew runIde

# Run tests with coverage
./gradlew check

# Run code quality inspection
./gradlew qodana

# Verify plugin compatibility
./gradlew verifyPlugin

# Publish to JetBrains Marketplace
./gradlew publishPlugin
```

## Architecture

The plugin follows **CQRS pattern** using the kediatr library with a central `TemporalMediator` coordinating all operations.

### Core Layers (dependency direction: cli/domain → state → usecase → ui)

- **cli/** - Temporal CLI interaction only. No dependencies on state or UI
- **domain/** - Domain models. No dependencies on state or UI
- **state/** - State storage only, no business logic. No dependencies on UI
- **usecase/** - High-level handlers, can interact with state
- **ui/** - Business UI implementation, grouped by features (toolWindow, workflows, details, navigation, settings)

### Key Components

- `TemporalMediator` (`TemporalMediator.kt`) - Central service locator, registers all query/command handlers
- `TemporalState` (`state/TemporalState.kt`) - Observable application state with persistence
- `CliExecutor` (`cli/utils/CliExecutor.kt`) - Executes Temporal CLI commands and parses output
- `WorkflowDefinitionFinder` (`ui/navigation/WorkflowDefinitionFinder.kt`) - Extension point for language-specific workflow navigation

### Extension Points

The plugin defines `WorkflowDefinitionFinder` for navigating to workflow definitions in code:
- `GoWorkflowFinder` - Go language support
- `JavaWorkflowPsiFinder` - Java language support (loaded via `java-support.xml`)

## Key Configuration Files

- `src/main/resources/META-INF/plugin.xml` - Plugin manifest, extensions, actions
- `src/main/resources/META-INF/java-support.xml` - Optional Java extension definitions
- `src/main/resources/messages/TemporalBundle.properties` - All UI strings (i18n)
- `gradle.properties` - Plugin metadata and platform version
- `gradle/libs.versions.toml` - Dependency version catalog

## Dependencies

Key libraries (versions in `gradle/libs.versions.toml`):
- **kediatr** - CQRS/Mediator pattern implementation
- **kotlinx-serialization-json** - JSON parsing for CLI output
- **IntelliJ Platform SDK** - IDE integration

## Testing

Tests use JUnit 4 with IntelliJ Platform TestFramework. Coverage reports generated by Kover.
